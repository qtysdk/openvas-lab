resources:
- type: compute.v1.instance
  name: example-instance
  properties:
    machineType: asia-east1
    metadata:
      items:
        - key: user-data
          value: |
            #cloud-config
            package_update: true
            package_upgrade: true

            apt:
              sources:
                docker.list:
                  source: deb [arch=amd64] https://download.docker.com/linux/ubuntu $RELEASE stable
                  keyid: 9DC858229FC7DD38854AE2D88D81803C0EBFCD88

            packages:
              - docker-ce
              - docker-ce-cli
              - containerd.io
              - docker-compose-plugin

            groups:
              - docker

            users:
              - default
              - name: ubuntu
                groups: [docker]

            runcmd:
              - systemctl enable docker
              - systemctl start docker

    disks:
      - deviceName: boot
        type: PERSISTENT
        boot: true
        autoDelete: true
        initializeParams:
          sourceImage: https://www.googleapis.com/compute/v1/projects/ubuntu-os-cloud/global/images/family/ubuntu-2204-lts